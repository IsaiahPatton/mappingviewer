<!DOCTYPE html>
<html>
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
<header class="w3-container w3-black"><h1>MinecraftMappings Viewer&nbsp;<sup><small>BETA</small></sup></h1></header>
<body>
<div class="w3-container pad">
<p>This tool creates transitive mappings for various Minecraft versions. (intermediary2yarn, spigot2yarn, mcp2intermediary, etc..)<br>
Original work by <a href="https://github.com/phase/">phase</a>. Updated by me. View mappings on Github: <a href="https://github.com/bukkitfabric/minecraftmappings">BukkitFabric/MinecraftMappings</a></p>

<style>
label {display: inline-block;min-width: 148px;}
form {display: inline-block; padding: 4px;}
input  {min-width:280px;}
select {min-width:280px;}
input, select {padding: 6px;}
.pad {padding-left:64px; padding-top:32px;}
footer {position:absolute; bottom:0; width:100%;}
</style>
<script>
function verChange() {
  var e = document.getElementById("ver");

  if (e.selectedIndex > 11) {
    e = document.getElementById("map");
    e.options[0].disabled = true;
    e.options[1].disabled = true;
    e.options[2].disabled = true;
    e.options[3].disabled = false;
    e.options[4].disabled = true;
    e.options[5].disabled = true;
    if (e.selectedIndex !== 3) e.selectedIndex = 3;
  } else {
    e = document.getElementById("map");
    e.options[0].disabled = false;
    e.options[1].disabled = false;
    e.options[2].disabled = false;
    e.options[3].disabled = false;
    e.options[4].disabled = false;
    e.options[5].disabled = false;
    if (e.selectedIndex == 3) e.selectedIndex = 0;
  }
}
</script>

<form>
  <label for="type">Choose a type:</label>
  <select name="type" id="type">
    <option value="FD">Field</option>
    <option value="MD">Method</option>
    <option value="CL">Class</option>
  </select>
</form>
<br>
<form>
  <label for="ver">Choose a version:</label>
  <select name="ver" id="ver" onChange="verChange()">
    <option value="1.16.3">1.16.3</option>
    <option value="1.16.2">1.16.2</option>
    <option value="1.16.1">1.16.1</option>
    <option value="1.15.2">1.15.2</option>
    <option value="1.14.4" disabled>1.14.4</option>
    <option value="1.13.2" disabled>1.13.2</option>
    <option value="1.12.2">1.12.2</option>
    <option value="1.11.2" disabled>1.11.2</option>
    <option value="1.10.2" disabled>1.10.2</option>
    <option value="1.9.4" disabled>1.9.4</option>
    <option value="1.8.9">1.8.9</option>
    <option value="1.8.8">1.8.8</option>
    <option value="1.7.10">1.7.10</option>
    <option value="1.7.2">1.7.2</option>
    <option value="1.6.4">1.6.4</option>
    <option value="1.5.2">1.5.2</option>
    <option value="1.4.7">1.4.7</option>
    <option value="1.3.2">1.3.2</option>
    <option value="1.2.5">1.2.5</option>
  </select>
</form>
<br>
<form>
  <label for="map">Mappings:</label>
  <select name="map" id="map">
    <option value="intermediary2yarn">Intermediary &#8594; Yarn</option>
    <option value="yarn2intermediary">Yarn &#8594; Intermediary</option>
    <option value="spigot2yarn">Spigot &#8594; Yarn</option>
    <option value="obf2intermediary">Obf &#8594; Spigot</option>
    <option value="obf2intermediary">Obf &#8594; Intermediary</option>
    <option value="intermediary2mcp">Intermediary &#8594; MCP</option>
  </select>
</form><br>
<form>
  <label for="value">Value to Search</label>
  <input type="text" id="value" name="value" placeholder="field_1234">
</form>

<br><br>
<script>
function doTest() {
  var e = document.getElementById("type");
  var type = e.options[e.selectedIndex].value;

  e = document.getElementById("ver");
  var ver = e.options[e.selectedIndex].value;

  e = document.getElementById("map");
  var map = e.options[e.selectedIndex].value;

  e = document.getElementById("value");
  var value = e.value;

  readTextFile("mappings/" + ver + ".json", value, type, map);
}
function getMapN(map) {
    if (map === "intermediary2yarn") return "intermediary";
    if (map === "spigot2yarn") return "spigot";
    if (map === "yarn2intermediary") return "yarn";
    if (map === "intermediary2mcp") return "intermediary";
    if (map === "obf2spigot") return "obf";
    if (map === "obf2intermediary") return "obf";
}
function getMapX(map) {
    if (map === "intermediary2yarn") return "obf,intermediary,yarn";
    if (map === "spigot2yarn") return "obf,spigot,yarn";
    if (map === "yarn2intermediary") return "yarn,intermediary,obf";
    if (map === "intermediary2mcp") return "obf,intermediary,mcp";
    if (map === "obf2spigot") return "obf,spigot";
    if (map === "obf2intermediary") return "obf,intermediary,yarn";
}
function readTextFile(file, value, map, mage) {
    var rawFile = new XMLHttpRequest();
    rawFile.open("GET", file, true);
    rawFile.onreadystatechange = function () {
        if(rawFile.readyState === 4) {
            if(rawFile.status === 200 || rawFile.status == 0) {
                var allText = rawFile.responseText;
                var myobj = JSON.parse(allText);

                if (map === "CL") {
                    var clazz = myobj.classes;
                    for (i = 0; i < clazz.length; i++) {
                        var claz = clazz[i];
                        if (claz[getMapN(mage)] === value) {
                            var writ = "Result: ";
                            var t = getMapX(mage).split(",");
                            for (var j = 0; j < t.length; j++)
                                writ += t[j] + "=" + claz[t[j]] + ", ";
                            document.getElementById("content").innerHTML = writ;
                            return;
                        }
                    }
                }

                if (map === "MD") {
                    var meths = myobj.methods;
                    for (i = 0; i < meths.length; i++) {
                        var claz = meths[i];
                        if (Object.keys(claz).includes("intermediary")) {
                            if (claz[getMapN(mage)].split(".")[1] === value) {
                                var writ = "Result: ";
                                var t = getMapX(mage).split(",");
                                for (var j = 0; j < t.length; j++)
                                    writ += t[j] + "=" + claz[t[j]] + ", ";
                                document.getElementById("content").innerHTML = writ;
                                return;
                            }
                        }
                    }
                }

                if (map === "FD") {
                    var fiels = myobj.fields;
                    for (i = 0; i < fiels.length; i++) {
                        var claz = fiels[i];
                        if (Object.keys(claz).includes("intermediary")) {
                            if (claz[getMapN(mage)].split(".")[1] === value) {
                                var writ = "Result: ";
                                var t = getMapX(mage).split(",");
                                for (var j = 0; j < t.length; j++)
                                    writ += t[j] + "=" + claz[t[j]] + ", ";
                                document.getElementById("content").innerHTML = writ;
                                return;
                            }
                        }
                    }
                }
                document.getElementById("content").innerHTML = "Not found?";
            }
        }
    }
    rawFile.send();
}
</script>
<button onclick="doTest()">Go Lookup</button>
<br><br><br>
<a href="https://billing.apexminecrafthosting.com/aff.php?aff=3548"><img src="https://apexminecrafthosting.com/images/apex-hosting-mobile.png" width="594" height="100" border="0"></a>
<br><br><br>
<p id="content">
&nbsp;<i>Output will be here.</i>
</p>

</div>
</body>
<footer class="w3-container w3-black"><small class="w3-small">Copyright &copy; 2020 <a href="https://github.com/BukkitFabric/MinecraftMappings/blob/master/LICENSE">under MIT</a> &nbsp;|&nbsp; View Mapping Data on <a href="https://github.com/bukkitfabric/minecraftmappings">Github</a></small></footer>
</html>
